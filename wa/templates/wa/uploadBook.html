{% extends "wa/base_main.html" %}

{% block content %}

{% load staticfiles %}

<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7/jquery.js"></script> 
<script src="http://malsup.github.com/jquery.form.js"></script>
<script type="text/javascript">
    $(document).ready(function() {

    var bar = $('.bar');
    var percent = $('.percent');
    var status = $('#status');

    $('#uploadBookId').ajaxForm({
        beforeSend: function() {
            status.empty();
            var percentVal = '0';
            console.log(percentVal);
            //bar.height(10);
            $('#progressbar').width(0);
            $('#progressbar').css('background-color', '#FF4500');
        },
        uploadProgress: function(event, position, total, percentComplete) {
            var percentVal = percentComplete;
            console.log(percentVal);
            $('#progressbar').width(percentVal+"%");
            //console.log(percentVal+'%');
        },
        complete: function(xhr) {
            ///alert(html(xhr.responseText));
            //window.location.href=("http://54.213.4.161/wa/audio/");
            console.log("Done");
        }
    });
}); 
</script>
<div class="col-sm-7 col-sm-offset-1">
    <div class="row">
        <!--<div class="col-sm-5">-->
            <div class="add-comment styled boxed" id="addcomments">             
                <div class="comment-form">
                    <form action="{% url "uploadBook" %}" method="post" enctype="multipart/form-data" id="uploadBookId">
                        <div class="form-inner">
                        <label></label>
                            {% csrf_token %}
                                <div class="field_text">
                                    <label>Book Name</label>
                                    <input type="text" name="bookName"></input>
                                </div>
                                <div class="field_text">
                                    <label>Author</label>
                                    <input type="text" name="author"></input>
                                </div>
                                <div class="field_select">
                                <label>Language</label>
                                <select id = "language" class="chosen" name="language">
                                <option value = "default">--Choose a Language--</option>
                                {% for lang in langs %}
                                        <option value = "{{lang.langName}}">{{lang.langName}}</option>
                                {% endfor %}
                                </select>
                                <script src="{% static "wa/arctic-sunset-css/js/jquery.chosen.min.js"%}"></script>
                                <script type="text/javascript">
                                jQuery(document).ready(function(){
                                    jQuery('#language').chosen();
                                });
                                </script>
                                </div>
                                <p>{{ form.non_field_errors }}</p>
                               
                                <p>
                                    {{ form.docfile.errors }}
                                    {{ form.docfile }}
                                </p>
                                <div class="progress" >
                                    <div class="bar" style="height:10px;" id="progressbar"></div >
                                </div>
                                <div id="status"></div>
                                <div class="rowSubmit">
                                <span class="btn btn-red">
                                <p><input type="submit" value="Upload Book" /></p>
                                </span></div>                                
                        </div>
                    </form>
                </div>
            </div>
            
    </div>
    <div class="row">
        
    </div>
</div>
{% endblock %}